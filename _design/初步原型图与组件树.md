
# 🎨 一、Figma 风格原型图（文字版布局示意）

> 模拟 Figma 界面层级、布局与交互逻辑（便于导入设计稿或绘制低保真图）。

---

## 🧭 JourneyOn 三阶段前端原型 — 总览

```
┌───────────────────────────────┐
│         🏠 我的行程页面（Home） │
│───────────────────────────────│
│ [＋ 创建新行程]                │
│ [TripCard] 成都周末游 → 11/20 │
│ [TripCard] 上海3日游 → 12/05  │
│───────────────────────────────│
│ 点击某个行程 → 进入 TripDetail │
└───────────────────────────────┘
```

---

## 🚀 TripDetail 页面（主容器）

```
┌───────────────────────────────┐
│  标题栏：成都周末游      [•••] │
│───────────────────────────────│
│  StageTabs: [Pre] [On] [Post] │
│───────────────────────────────│
│  对应阶段内容（下方三种视图） │
│───────────────────────────────│
│  🗨️ 浮动按钮：打开 AI 面板      │
└───────────────────────────────┘
```

---

### ① Pre-Trip 阶段（行前规划）

```
┌───────────────────────────────┐
│ ⏱ 行程概览卡：3天2晚，预算1500 │
│───────────────────────────────│
│ 🗺 推荐路线卡（Day1 / Day2）     │
│   └▶ 景点锚点 + 酒店选项        │
│───────────────────────────────│
│ 💰 预算对比卡（酒店/航班）      │
│───────────────────────────────│
│ 📋 任务清单（签证/打包/预订）   │
│───────────────────────────────│
│ 🌦 天气小组件 + 装备建议        │
│───────────────────────────────│
│ 🧠 [AI规划助手按钮]             │
│    点击 → 右滑出 ChatPanel      │
└───────────────────────────────┘
```

---

### ② On-Trip 阶段（旅行中）

```
┌───────────────────────────────┐
│ 📅 当日日程（Timeline）         │
│───────────────────────────────│
│ 🚨 告警提示（延误/天气）        │
│───────────────────────────────│
│ 📍 附近推荐卡（景点/餐厅）      │
│───────────────────────────────│
│ 🗺 离线地图卡（导航/出发提醒）  │
│───────────────────────────────│
│ 💬 [AI随行助手按钮]             │
│    → 右滑出 ChatPanel           │
└───────────────────────────────┘
```

---

### ③ Post-Trip 阶段（旅后总结）

```
┌───────────────────────────────┐
│ 🧾 旅行报告 SummaryCard        │
│   · 行程摘要 + 地图足迹        │
│───────────────────────────────│
│ 📸 回忆相册                    │
│───────────────────────────────│
│ 🏷 偏好标签 Chips              │
│───────────────────────────────│
│ 💡 改进建议卡（LLM输出）       │
│───────────────────────────────│
│ 💬 [AI回顾助手按钮]             │
│    → 右滑出 ChatPanel           │
└───────────────────────────────┘
```

---

## 💬 ChatPanel（统一右滑出抽屉）

```
┌───────────────────────────────┐
│ 👤 用户消息气泡                │
│ 🤖 Agent 回复卡（结构化输出）  │
│  ├─ 推荐卡（卡片点击打开地图） │
│  ├─ 任务更新（checkbox）       │
│  └─ 提醒按钮（确认 / 拒绝）    │
│───────────────────────────────│
│ 📝 输入框 + 发送按钮            │
└───────────────────────────────┘
```

---

# ⚛️ 二、React Native 组件树（结构图）

以下是可直接指导开发的组件分层（React Navigation + Zustand 状态管理）：

```
App
├── NavigationContainer
│   ├── StackNavigator
│   │   ├── HomeScreen
│   │   │   ├── TripList
│   │   │   │   └── TripCard
│   │   │   └── CreateTripModal
│   │   └── TripDetailScreen
│   │       ├── StageTabs (Tabs: PreTrip / OnTrip / PostTrip)
│   │       │   ├── PreTripScreen
│   │       │   │   ├── TripSummaryCard
│   │       │   │   ├── RoutePlanList
│   │       │   │   ├── BudgetCompareCard
│   │       │   │   ├── TaskList
│   │       │   │   └── WeatherTipCard
│   │       │   ├── OnTripScreen
│   │       │   │   ├── TimelineView
│   │       │   │   ├── AlertBanner
│   │       │   │   ├── NearbyRecommendationList
│   │       │   │   └── OfflineMapCard
│   │       │   └── PostTripScreen
│   │       │       ├── ReportSummaryCard
│   │       │       ├── MemoryGallery
│   │       │       ├── TagList
│   │       │       └── SuggestionList
│   │       └── FloatingChatButton
│   │           └── ChatPanel (Drawer)
│   │               ├── MessageList
│   │               │   ├── UserBubble
│   │               │   └── AgentBubble
│   │               └── ChatInputBar
│   └── SettingsScreen
│
├── hooks/
│   ├── useTripStore (Zustand 状态)
│   ├── useAgentChat (WebSocket 实时通信)
│   └── useOfflineCache (AsyncStorage)
│
├── services/
│   ├── apiClient (axios 实例)
│   ├── tripService
│   ├── taskService
│   └── agentService
│
└── components/ui/
    ├── Card, Button, Chip, Modal
    ├── Timeline, MapView, Chart
    └── LoadingSpinner
```

---

# 🔄 三、状态流示意（跨阶段）

```
[HomeScreen]
   ↓ 选择行程
[TripDetailScreen]
   ↓ 用户进入某阶段
[StageTabs]
   ↓ 触发 Chat → WebSocket 连接
[ChatPanel]
   ↔ Orchestrator Stream 回复
   ↓
[UI 更新]
   ↳ 更新 TaskList / Itinerary / AlertBanner
   ↳ 状态写入 Zustand + 后端 API
```

每个阶段共享：

* trip_id + stage 作为上下文主键
* 实时流式输出（LLM streaming）
* 状态存储（Zustand）
* 缓存（AsyncStorage）

# 后端接口需求文档

## 一、非 AI 接口

### 1. 身份认证与用户资料
- **登录接口**
  - **用途**：提交邮箱、密码，返回访问令牌与用户基本信息（`id`、`name`、`email`）。
  - **交互要点**：支持错误提示，成功后刷新前端登录态。
- **注册接口**
  - **用途**：提交邮箱、密码、昵称，创建新用户并返回登录态及基础资料。
  - **交互要点**：校验邮箱唯一性，与登录接口返回结构保持一致。
- **退出登录接口**
  - **用途**：销毁服务端会话或令牌。
  - **交互要点**：前端收到成功响应后跳转至登录页。
- **个人资料编辑接口**
  - **用途**：更新昵称、邮箱等资料。
  - **交互要点**：返回最新用户信息以刷新前端状态。

### 2. 行程基础数据
- **行程列表接口**
  - **用途**：返回用户全部行程。
  - **核心字段**：`id`、`title`、`fromCity`、`toCity`、`startDate`、`duration`、`budget`、`theme`、`stage (pre/on/post)`、`archived`。
- **行程详情接口**
  - **用途**：按 `id` 返回单个行程的完整信息，支撑阶段页展示。
- **创建行程接口**
  - **用途**：创建新行程并返回行程全量数据及 `id`。
  - **交互要点**：用于行前阶段页面跳转。

### 3. 行程阶段与归档
- **行程阶段推进接口**
  - **用途**：将行程阶段按 `pre → on → post` 顺序推进。
  - **交互要点**：返回更新后的阶段状态，供按钮禁用逻辑使用。
- **行程归档接口**
  - **用途**：将行程标记为归档并确保阶段为 `post`。
  - **交互要点**：成功后行程应从在途列表转入归档分组。

### 4. 行前任务管理
- **任务列表接口**
  - **用途**：返回行前任务列表，包含 `id`、`title`、`description`、`done`。
- **新增任务接口**
  - **用途**：创建任务，返回完整任务记录。
- **更新任务接口**
  - **用途**：修改任务标题、描述或完成状态。
  - **交互要点**：支持复选框切换与详情编辑。

## 二、AI 相关接口

### 1. 行程洞察与内容服务
- **行前阶段内容接口**
  - **用途**：根据行程信息提供行程规划草案、天气提醒等智能建议，可集成 AI 生成或第三方气象数据。
  - **交互要点**：返回结构化卡片数据，供前端展示多种提醒类型。
- **在途阶段内容接口**
  - **用途**：提供当日日程、附近推荐、告警通知、离线地图等实时内容，可融合外部服务或 AI 推荐。
  - **交互要点**：支持按日期或定位查询，保证数据及时性。
- **回顾阶段内容接口**
  - **用途**：生成旅行总结、相册整理、偏好标签、下次建议等内容。
  - **交互要点**：可结合 AI 生成行程总结、图像整理结果等信息。

